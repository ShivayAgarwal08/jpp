import { PostgrestClient } from "@supabase/postgrest-js";
import { ClientInfo, X_NEON_CLIENT_INFO_HEADER, getClientInfo } from "@neondatabase/internal";

//#region src/client/postgrest-client.d.ts
type NeonPostgrestClientConstructorOptions<SchemaName> = {
  dataApiUrl: string;
  options?: {
    db?: {
      schema?: Exclude<SchemaName, '__InternalSupabase'>;
    };
    global?: {
      fetch: typeof fetch;
      headers?: Record<string, string>;
    };
  };
};
type DefaultSchemaName<Database> = 'public' extends keyof Database ? 'public' : string & keyof Database;
/**
 * Neon PostgreSQL client for querying the Neon Data API
 *
 * This is a generic PostgreSQL client without authentication built-in.
 * For auth-integrated clients, use @neondatabase/neon-js instead.
 *
 * Extends the upstream PostgrestClient with Neon-specific configuration.
 */
declare class NeonPostgrestClient<Database = any, SchemaName extends string & keyof Database = DefaultSchemaName<Database>> extends PostgrestClient<Database, {
  PostgrestVersion: '12';
}, Exclude<SchemaName, '__InternalSupabase'>> {
  constructor({
    dataApiUrl,
    options
  }: NeonPostgrestClientConstructorOptions<SchemaName>);
}
//#endregion
//#region src/client/fetch-with-token.d.ts
/**
 * Fetch wrapper that automatically injects authentication tokens
 * Generic utility for adding token-based authentication to requests
 */
type Fetch = typeof fetch;
type GetAccessToken = () => Promise<string | null>;
/**
 * Error thrown when authentication is required but no token is available
 */
declare class AuthRequiredError extends Error {
  constructor(message?: string);
}
/**
 * Creates a fetch wrapper that injects authentication tokens into every request
 *
 * This is a generic utility that can work with any token provider function.
 * The token is resolved lazily on each request.
 *
 * @param getAccessToken - Async function that returns current access token
 * @param customFetch - Optional custom fetch implementation
 * @returns Wrapped fetch function with authentication headers
 */
declare function fetchWithToken(getAccessToken: GetAccessToken, customFetch?: Fetch): Fetch;
//#endregion
//#region src/utils/client-info.d.ts
declare const injectClientInfo: (headers: HeadersInit | undefined, sdkOverride?: {
  name: string;
  version: string;
}) => Headers;
//#endregion
export { AuthRequiredError, type ClientInfo, type DefaultSchemaName, NeonPostgrestClient, type NeonPostgrestClientConstructorOptions, X_NEON_CLIENT_INFO_HEADER, fetchWithToken, getClientInfo, injectClientInfo };