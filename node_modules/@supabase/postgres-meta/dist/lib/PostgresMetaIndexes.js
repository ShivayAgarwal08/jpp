import { DEFAULT_SYSTEM_SCHEMAS } from './constants.js';
import { filterByList, filterByValue } from './helpers.js';
import { INDEXES_SQL } from './sql/indexes.sql.js';
export default class PostgresMetaIndexes {
    query;
    constructor(query) {
        this.query = query;
    }
    async list({ includeSystemSchemas = false, includedSchemas, excludedSchemas, limit, offset, } = {}) {
        const schemaFilter = filterByList(includedSchemas, excludedSchemas, !includeSystemSchemas ? DEFAULT_SYSTEM_SCHEMAS : undefined);
        const sql = INDEXES_SQL({ schemaFilter, limit, offset });
        return await this.query(sql);
    }
    async retrieve({ id, }) {
        if (id) {
            const idsFilter = filterByValue([id]);
            const sql = INDEXES_SQL({ idsFilter });
            const { data, error } = await this.query(sql);
            if (error) {
                return { data, error };
            }
            else if (data.length === 0) {
                return { data: null, error: { message: `Cannot find a index with ID ${id}` } };
            }
            else {
                return { data: data[0], error };
            }
        }
        else {
            return { data: null, error: { message: 'Invalid parameters on function retrieve' } };
        }
    }
}
//# sourceMappingURL=PostgresMetaIndexes.js.map